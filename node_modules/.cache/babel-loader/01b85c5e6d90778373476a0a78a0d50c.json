{"ast":null,"code":"import { BaseMessageSignerWalletAdapter, scopePollingDetectionStrategy, WalletAccountError, WalletConnectionError, WalletDisconnectionError, WalletError, WalletNotConnectedError, WalletNotReadyError, WalletPublicKeyError, WalletReadyState, WalletSignTransactionError } from '@solana/wallet-adapter-base';\nimport { PublicKey } from '@solana/web3.js';\nimport bs58 from 'bs58';\nexport const SlopeWalletName = 'Slope';\nexport class SlopeWalletAdapter extends BaseMessageSignerWalletAdapter {\n  constructor() {\n    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    super();\n    this.name = SlopeWalletName;\n    this.url = 'https://slope.finance';\n    this.icon = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iNjQiIGZpbGw9IiM2RTY2RkEiLz4KPHBhdGggZD0iTTI3Ljk0NzUgNTIuMTU5Nkw1MS45ODI2IDI4LjA1NzJMNzIuNjA5OCA3LjY1Mzg5QzczLjg3MzQgNi40MDQwMSA3Ni4wMTc4IDcuMjk5MSA3Ni4wMTc4IDkuMDc2NDJMNzYuMDE4NyA1Mi4xNTlMNTEuOTgzNiA3Ni4xMjY4TDI3Ljk0NzUgNTIuMTU5NloiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcl8zNzk1XzI1NTQzKSIvPgo8cGF0aCBkPSJNMTAwLjA1MyA3NS45OTNMNzYuMDE4IDUxLjk1OEw1MS45ODI5IDc1Ljk5MzFMNTEuOTgyOSAxMTguOTI0QzUxLjk4MjkgMTIwLjcwMyA1NC4xMzEyIDEyMS41OTcgNTUuMzkzNyAxMjAuMzQzTDEwMC4wNTMgNzUuOTkzWiIgZmlsbD0idXJsKCNwYWludDFfbGluZWFyXzM3OTVfMjU1NDMpIi8+CjxwYXRoIGQ9Ik0yNy45NDcgNTIuMTYwMUg0NC42ODM5QzQ4LjcxNDcgNTIuMTYwMSA1MS45ODIyIDU1LjQyNzYgNTEuOTgyMiA1OS40NTgzVjc2LjEyNjlIMzUuMjQ1M0MzMS4yMTQ2IDc2LjEyNjkgMjcuOTQ3IDcyLjg1OTQgMjcuOTQ3IDY4LjgyODdWNTIuMTYwMVoiIGZpbGw9IiNGMUYwRkYiLz4KPHBhdGggZD0iTTc2LjAxNzggNTIuMTYwMUg5Mi43NTQ3Qzk2Ljc4NTUgNTIuMTYwMSAxMDAuMDUzIDU1LjQyNzYgMTAwLjA1MyA1OS40NTgzVjc2LjEyNjlIODMuMzE2MUM3OS4yODU0IDc2LjEyNjkgNzYuMDE3OCA3Mi44NTk0IDc2LjAxNzggNjguODI4N1Y1Mi4xNjAxWiIgZmlsbD0iI0YxRjBGRiIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDBfbGluZWFyXzM3OTVfMjU1NDMiIHgxPSI1MS45ODMxIiB5MT0iNy4wNzE1NSIgeDI9IjUxLjk4MzEiIHkyPSI3Ni4xMjY4IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiNBOEFERkYiLz4KPHN0b3Agb2Zmc2V0PSIwLjY0ODU1NiIgc3RvcC1jb2xvcj0id2hpdGUiLz4KPC9saW5lYXJHcmFkaWVudD4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDFfbGluZWFyXzM3OTVfMjU1NDMiIHgxPSI3Ni4wMTgiIHkxPSI1MS45NTgiIHgyPSI3Ni4wMTgiIHkyPSIxMjAuOTI4IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIG9mZnNldD0iMC4yNjA3ODQiIHN0b3AtY29sb3I9IiNCNkJBRkYiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjRTRFMkZGIi8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+Cg==';\n    this._readyState = typeof window === 'undefined' || typeof document === 'undefined' ? WalletReadyState.Unsupported : WalletReadyState.NotDetected;\n    this._connecting = false;\n    this._wallet = null;\n    this._publicKey = null;\n\n    if (this._readyState !== WalletReadyState.Unsupported) {\n      scopePollingDetectionStrategy(() => {\n        if (typeof window.Slope === 'function' || window.slopeApp) {\n          this._readyState = WalletReadyState.Installed;\n          this.emit('readyStateChange', this._readyState);\n          return true;\n        }\n\n        return false;\n      });\n    }\n  }\n\n  get publicKey() {\n    return this._publicKey;\n  }\n\n  get connecting() {\n    return this._connecting;\n  }\n\n  get readyState() {\n    return this._readyState;\n  }\n\n  async connect() {\n    try {\n      if (this.connected || this.connecting) return;\n      if (this._readyState !== WalletReadyState.Installed || !window.Slope) throw new WalletNotReadyError();\n      this._connecting = true;\n      const wallet = new window.Slope();\n      let data;\n\n      try {\n        ({\n          data\n        } = await wallet.connect());\n      } catch (error) {\n        throw new WalletConnectionError(error === null || error === void 0 ? void 0 : error.message, error);\n      }\n\n      if (!data.publicKey) throw new WalletAccountError();\n      let publicKey;\n\n      try {\n        publicKey = new PublicKey(data.publicKey);\n      } catch (error) {\n        throw new WalletPublicKeyError(error === null || error === void 0 ? void 0 : error.message, error);\n      }\n\n      this._wallet = wallet;\n      this._publicKey = publicKey;\n      this.emit('connect', publicKey);\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    } finally {\n      this._connecting = false;\n    }\n  }\n\n  async disconnect() {\n    const wallet = this._wallet;\n\n    if (wallet) {\n      this._wallet = null;\n      this._publicKey = null;\n\n      try {\n        const {\n          msg\n        } = await wallet.disconnect();\n        if (msg !== 'ok') throw new WalletDisconnectionError(msg);\n      } catch (error) {\n        if (!(error instanceof WalletError)) {\n          // eslint-disable-next-line no-ex-assign\n          error = new WalletDisconnectionError(error === null || error === void 0 ? void 0 : error.message, error);\n        }\n\n        this.emit('error', error);\n      }\n    }\n\n    this.emit('disconnect');\n  }\n\n  async signTransaction(transaction) {\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n\n      try {\n        const message = bs58.encode(transaction.serializeMessage());\n        const {\n          msg,\n          data\n        } = await wallet.signTransaction(message);\n        if (!data.publicKey || !data.signature) throw new WalletSignTransactionError(msg);\n        const publicKey = new PublicKey(data.publicKey);\n        const signature = bs58.decode(data.signature);\n        transaction.addSignature(publicKey, signature);\n        return transaction;\n      } catch (error) {\n        if (error instanceof WalletError) throw error;\n        throw new WalletSignTransactionError(error === null || error === void 0 ? void 0 : error.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n\n  async signAllTransactions(transactions) {\n    var _a;\n\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n\n      try {\n        const messages = transactions.map(transaction => bs58.encode(transaction.serializeMessage()));\n        const {\n          msg,\n          data\n        } = await wallet.signAllTransactions(messages);\n        const length = transactions.length;\n        if (!data.publicKey || ((_a = data.signatures) === null || _a === void 0 ? void 0 : _a.length) !== length) throw new WalletSignTransactionError(msg);\n        const publicKey = new PublicKey(data.publicKey);\n\n        for (let i = 0; i < length; i++) {\n          transactions[i].addSignature(publicKey, bs58.decode(data.signatures[i]));\n        }\n\n        return transactions;\n      } catch (error) {\n        if (error instanceof WalletError) throw error;\n        throw new WalletSignTransactionError(error === null || error === void 0 ? void 0 : error.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n\n  async signMessage(message) {\n    try {\n      const wallet = this._wallet;\n      if (!wallet) throw new WalletNotConnectedError();\n\n      try {\n        const response = await wallet.signMessage(message);\n        return bs58.decode(response.data.signature);\n      } catch (error) {\n        throw new WalletSignTransactionError(error === null || error === void 0 ? void 0 : error.message, error);\n      }\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n\n}","map":{"version":3,"mappings":"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","names":["BaseMessageSignerWalletAdapter","scopePollingDetectionStrategy","WalletAccountError","WalletConnectionError","WalletDisconnectionError","WalletError","WalletNotConnectedError","WalletNotReadyError","WalletPublicKeyError","WalletReadyState","WalletSignTransactionError","PublicKey","bs58","SlopeWalletName","SlopeWalletAdapter","constructor","config","window","document","Unsupported","NotDetected","_connecting","_wallet","_publicKey","_readyState","Slope","slopeApp","Installed","emit","publicKey","connecting","readyState","connect","connected","wallet","data","error","message","disconnect","msg","signTransaction","transaction","encode","serializeMessage","signature","decode","addSignature","signAllTransactions","transactions","messages","map","length","signatures","_a","i","signMessage","response"],"sources":["/Users/bryan/solana-crowdfunding/.yarn/cache/@solana-wallet-adapter-slope-npm-0.5.4-347c59cc5f-9945326267.zip/node_modules/@solana/wallet-adapter-slope/src/adapter.ts"],"sourcesContent":["import {\n    BaseMessageSignerWalletAdapter,\n    scopePollingDetectionStrategy,\n    WalletAccountError,\n    WalletConnectionError,\n    WalletDisconnectionError,\n    WalletError,\n    WalletName,\n    WalletNotConnectedError,\n    WalletNotReadyError,\n    WalletPublicKeyError,\n    WalletReadyState,\n    WalletSignTransactionError,\n} from '@solana/wallet-adapter-base';\nimport { PublicKey, Transaction } from '@solana/web3.js';\nimport bs58 from 'bs58';\n\ninterface SlopeWallet {\n    connect(): Promise<{\n        msg: string;\n        data: {\n            publicKey?: string;\n        };\n    }>;\n    disconnect(): Promise<{ msg: string }>;\n    signTransaction(message: string): Promise<{\n        msg: string;\n        data: {\n            publicKey?: string;\n            signature?: string;\n        };\n    }>;\n    signAllTransactions(messages: string[]): Promise<{\n        msg: string;\n        data: {\n            publicKey?: string;\n            signatures?: string[];\n        };\n    }>;\n    signMessage(message: Uint8Array): Promise<{ data: { signature: string } }>;\n}\n\ninterface SlopeWindow extends Window {\n    Slope?: {\n        new (): SlopeWallet;\n    };\n    slopeApp?: unknown;\n}\n\ndeclare const window: SlopeWindow;\n\nexport interface SlopeWalletAdapterConfig {}\n\nexport const SlopeWalletName = 'Slope' as WalletName;\n\nexport class SlopeWalletAdapter extends BaseMessageSignerWalletAdapter {\n    name = SlopeWalletName;\n    url = 'https://slope.finance';\n    icon =\n        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iNjQiIGZpbGw9IiM2RTY2RkEiLz4KPHBhdGggZD0iTTI3Ljk0NzUgNTIuMTU5Nkw1MS45ODI2IDI4LjA1NzJMNzIuNjA5OCA3LjY1Mzg5QzczLjg3MzQgNi40MDQwMSA3Ni4wMTc4IDcuMjk5MSA3Ni4wMTc4IDkuMDc2NDJMNzYuMDE4NyA1Mi4xNTlMNTEuOTgzNiA3Ni4xMjY4TDI3Ljk0NzUgNTIuMTU5NloiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcl8zNzk1XzI1NTQzKSIvPgo8cGF0aCBkPSJNMTAwLjA1MyA3NS45OTNMNzYuMDE4IDUxLjk1OEw1MS45ODI5IDc1Ljk5MzFMNTEuOTgyOSAxMTguOTI0QzUxLjk4MjkgMTIwLjcwMyA1NC4xMzEyIDEyMS41OTcgNTUuMzkzNyAxMjAuMzQzTDEwMC4wNTMgNzUuOTkzWiIgZmlsbD0idXJsKCNwYWludDFfbGluZWFyXzM3OTVfMjU1NDMpIi8+CjxwYXRoIGQ9Ik0yNy45NDcgNTIuMTYwMUg0NC42ODM5QzQ4LjcxNDcgNTIuMTYwMSA1MS45ODIyIDU1LjQyNzYgNTEuOTgyMiA1OS40NTgzVjc2LjEyNjlIMzUuMjQ1M0MzMS4yMTQ2IDc2LjEyNjkgMjcuOTQ3IDcyLjg1OTQgMjcuOTQ3IDY4LjgyODdWNTIuMTYwMVoiIGZpbGw9IiNGMUYwRkYiLz4KPHBhdGggZD0iTTc2LjAxNzggNTIuMTYwMUg5Mi43NTQ3Qzk2Ljc4NTUgNTIuMTYwMSAxMDAuMDUzIDU1LjQyNzYgMTAwLjA1MyA1OS40NTgzVjc2LjEyNjlIODMuMzE2MUM3OS4yODU0IDc2LjEyNjkgNzYuMDE3OCA3Mi44NTk0IDc2LjAxNzggNjguODI4N1Y1Mi4xNjAxWiIgZmlsbD0iI0YxRjBGRiIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDBfbGluZWFyXzM3OTVfMjU1NDMiIHgxPSI1MS45ODMxIiB5MT0iNy4wNzE1NSIgeDI9IjUxLjk4MzEiIHkyPSI3Ni4xMjY4IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiNBOEFERkYiLz4KPHN0b3Agb2Zmc2V0PSIwLjY0ODU1NiIgc3RvcC1jb2xvcj0id2hpdGUiLz4KPC9saW5lYXJHcmFkaWVudD4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDFfbGluZWFyXzM3OTVfMjU1NDMiIHgxPSI3Ni4wMTgiIHkxPSI1MS45NTgiIHgyPSI3Ni4wMTgiIHkyPSIxMjAuOTI4IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIG9mZnNldD0iMC4yNjA3ODQiIHN0b3AtY29sb3I9IiNCNkJBRkYiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjRTRFMkZGIi8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+Cg==';\n\n    private _connecting: boolean;\n    private _wallet: SlopeWallet | null;\n    private _publicKey: PublicKey | null;\n    private _readyState: WalletReadyState =\n        typeof window === 'undefined' || typeof document === 'undefined'\n            ? WalletReadyState.Unsupported\n            : WalletReadyState.NotDetected;\n\n    constructor(config: SlopeWalletAdapterConfig = {}) {\n        super();\n        this._connecting = false;\n        this._wallet = null;\n        this._publicKey = null;\n\n        if (this._readyState !== WalletReadyState.Unsupported) {\n            scopePollingDetectionStrategy(() => {\n                if (typeof window.Slope === 'function' || window.slopeApp) {\n                    this._readyState = WalletReadyState.Installed;\n                    this.emit('readyStateChange', this._readyState);\n                    return true;\n                }\n                return false;\n            });\n        }\n    }\n\n    get publicKey(): PublicKey | null {\n        return this._publicKey;\n    }\n\n    get connecting(): boolean {\n        return this._connecting;\n    }\n\n    get readyState(): WalletReadyState {\n        return this._readyState;\n    }\n\n    async connect(): Promise<void> {\n        try {\n            if (this.connected || this.connecting) return;\n            if (this._readyState !== WalletReadyState.Installed || !window.Slope) throw new WalletNotReadyError();\n\n            this._connecting = true;\n\n            const wallet = new window.Slope();\n\n            let data: { publicKey?: string | undefined };\n            try {\n                ({ data } = await wallet.connect());\n            } catch (error: any) {\n                throw new WalletConnectionError(error?.message, error);\n            }\n\n            if (!data.publicKey) throw new WalletAccountError();\n\n            let publicKey: PublicKey;\n            try {\n                publicKey = new PublicKey(data.publicKey);\n            } catch (error: any) {\n                throw new WalletPublicKeyError(error?.message, error);\n            }\n\n            this._wallet = wallet;\n            this._publicKey = publicKey;\n\n            this.emit('connect', publicKey);\n        } catch (error: any) {\n            this.emit('error', error);\n            throw error;\n        } finally {\n            this._connecting = false;\n        }\n    }\n\n    async disconnect(): Promise<void> {\n        const wallet = this._wallet;\n        if (wallet) {\n            this._wallet = null;\n            this._publicKey = null;\n\n            try {\n                const { msg } = await wallet.disconnect();\n                if (msg !== 'ok') throw new WalletDisconnectionError(msg);\n            } catch (error: any) {\n                if (!(error instanceof WalletError)) {\n                    // eslint-disable-next-line no-ex-assign\n                    error = new WalletDisconnectionError(error?.message, error);\n                }\n                this.emit('error', error);\n            }\n        }\n\n        this.emit('disconnect');\n    }\n\n    async signTransaction(transaction: Transaction): Promise<Transaction> {\n        try {\n            const wallet = this._wallet;\n            if (!wallet) throw new WalletNotConnectedError();\n\n            try {\n                const message = bs58.encode(transaction.serializeMessage());\n                const { msg, data } = await wallet.signTransaction(message);\n\n                if (!data.publicKey || !data.signature) throw new WalletSignTransactionError(msg);\n\n                const publicKey = new PublicKey(data.publicKey);\n                const signature = bs58.decode(data.signature);\n\n                transaction.addSignature(publicKey, signature);\n                return transaction;\n            } catch (error: any) {\n                if (error instanceof WalletError) throw error;\n                throw new WalletSignTransactionError(error?.message, error);\n            }\n        } catch (error: any) {\n            this.emit('error', error);\n            throw error;\n        }\n    }\n\n    async signAllTransactions(transactions: Transaction[]): Promise<Transaction[]> {\n        try {\n            const wallet = this._wallet;\n            if (!wallet) throw new WalletNotConnectedError();\n\n            try {\n                const messages = transactions.map((transaction) => bs58.encode(transaction.serializeMessage()));\n                const { msg, data } = await wallet.signAllTransactions(messages);\n\n                const length = transactions.length;\n                if (!data.publicKey || data.signatures?.length !== length) throw new WalletSignTransactionError(msg);\n\n                const publicKey = new PublicKey(data.publicKey);\n\n                for (let i = 0; i < length; i++) {\n                    transactions[i].addSignature(publicKey, bs58.decode(data.signatures[i]));\n                }\n\n                return transactions;\n            } catch (error: any) {\n                if (error instanceof WalletError) throw error;\n                throw new WalletSignTransactionError(error?.message, error);\n            }\n        } catch (error: any) {\n            this.emit('error', error);\n            throw error;\n        }\n    }\n\n    async signMessage(message: Uint8Array): Promise<Uint8Array> {\n        try {\n            const wallet = this._wallet;\n            if (!wallet) throw new WalletNotConnectedError();\n\n            try {\n                const response = await wallet.signMessage(message);\n                return bs58.decode(response.data.signature);\n            } catch (error: any) {\n                throw new WalletSignTransactionError(error?.message, error);\n            }\n        } catch (error: any) {\n            this.emit('error', error);\n            throw error;\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"module"}