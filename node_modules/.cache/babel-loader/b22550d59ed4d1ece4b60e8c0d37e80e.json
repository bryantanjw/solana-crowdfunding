{"ast":null,"code":"import { BaseSignerWalletAdapter, WalletConnectionError, WalletDisconnectedError, WalletDisconnectionError, WalletLoadError, WalletNotConnectedError, WalletNotReadyError, WalletPublicKeyError, WalletReadyState, WalletSignTransactionError } from '@solana/wallet-adapter-base';\nimport './polyfills/index.mjs';\nimport { getDerivationPath, getPublicKey, signTransaction } from './util.mjs';\nexport const LedgerWalletName = 'Ledger';\nexport class LedgerWalletAdapter extends BaseSignerWalletAdapter {\n  constructor() {\n    let config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    super();\n    this.name = LedgerWalletName;\n    this.url = 'https://ledger.com';\n    this.icon = 'data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzUgMzUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iI2ZmZiI+PHBhdGggZD0ibTIzLjU4OCAwaC0xNnYyMS41ODNoMjEuNnYtMTZhNS41ODUgNS41ODUgMCAwIDAgLTUuNi01LjU4M3oiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuNzM5KSIvPjxwYXRoIGQ9Im04LjM0MiAwaC0yLjc1N2E1LjU4NSA1LjU4NSAwIDAgMCAtNS41ODUgNS41ODV2Mi43NTdoOC4zNDJ6Ii8+PHBhdGggZD0ibTAgNy41OWg4LjM0MnY4LjM0MmgtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDUuNzM5KSIvPjxwYXRoIGQ9Im0xNS4xOCAyMy40NTFoMi43NTdhNS41ODUgNS41ODUgMCAwIDAgNS41ODUtNS42di0yLjY3MWgtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMS40NzggMTEuNDc4KSIvPjxwYXRoIGQ9Im03LjU5IDE1LjE4aDguMzQydjguMzQyaC04LjM0MnoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuNzM5IDExLjQ3OCkiLz48cGF0aCBkPSJtMCAxNS4xOHYyLjc1N2E1LjU4NSA1LjU4NSAwIDAgMCA1LjU4NSA1LjU4NWgyLjc1N3YtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDExLjQ3OCkiLz48L2c+PC9zdmc+';\n    this._readyState = typeof navigator === 'undefined' || !navigator.hid ? WalletReadyState.Unsupported : WalletReadyState.Loadable;\n\n    this._disconnected = () => {\n      const transport = this._transport;\n\n      if (transport) {\n        transport.off('disconnect', this._disconnected);\n        this._transport = null;\n        this._publicKey = null;\n        this.emit('error', new WalletDisconnectedError());\n        this.emit('disconnect');\n      }\n    };\n\n    this._derivationPath = config.derivationPath || getDerivationPath(0, 0);\n    this._connecting = false;\n    this._transport = null;\n    this._publicKey = null;\n  }\n\n  get publicKey() {\n    return this._publicKey;\n  }\n\n  get connecting() {\n    return this._connecting;\n  }\n\n  get readyState() {\n    return this._readyState;\n  }\n\n  async connect() {\n    try {\n      if (this.connected || this.connecting) return;\n      if (this._readyState === WalletReadyState.Unsupported) throw new WalletNotReadyError();\n      this._connecting = true;\n      let TransportWebHIDClass;\n\n      try {\n        ({\n          default: TransportWebHIDClass\n        } = await import('@ledgerhq/hw-transport-webhid'));\n      } catch (error) {\n        throw new WalletLoadError(error === null || error === void 0 ? void 0 : error.message, error);\n      }\n\n      let transport;\n\n      try {\n        transport = await TransportWebHIDClass.create();\n      } catch (error) {\n        throw new WalletConnectionError(error === null || error === void 0 ? void 0 : error.message, error);\n      }\n\n      let publicKey;\n\n      try {\n        publicKey = await getPublicKey(transport, this._derivationPath);\n      } catch (error) {\n        throw new WalletPublicKeyError(error === null || error === void 0 ? void 0 : error.message, error);\n      }\n\n      transport.on('disconnect', this._disconnected);\n      this._transport = transport;\n      this._publicKey = publicKey;\n      this.emit('connect', publicKey);\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    } finally {\n      this._connecting = false;\n    }\n  }\n\n  async disconnect() {\n    const transport = this._transport;\n\n    if (transport) {\n      transport.off('disconnect', this._disconnected);\n      this._transport = null;\n      this._publicKey = null;\n\n      try {\n        await transport.close();\n      } catch (error) {\n        this.emit('error', new WalletDisconnectionError(error === null || error === void 0 ? void 0 : error.message, error));\n      }\n    }\n\n    this.emit('disconnect');\n  }\n\n  async signTransaction(transaction) {\n    try {\n      const transport = this._transport;\n      const publicKey = this._publicKey;\n      if (!transport || !publicKey) throw new WalletNotConnectedError();\n\n      try {\n        const signature = await signTransaction(transport, transaction, this._derivationPath);\n        transaction.addSignature(publicKey, signature);\n      } catch (error) {\n        throw new WalletSignTransactionError(error === null || error === void 0 ? void 0 : error.message, error);\n      }\n\n      return transaction;\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n\n  async signAllTransactions(transactions) {\n    try {\n      const transport = this._transport;\n      const publicKey = this._publicKey;\n      if (!transport || !publicKey) throw new WalletNotConnectedError();\n\n      try {\n        const derivationPath = this._derivationPath;\n\n        for (const transaction of transactions) {\n          const signature = await signTransaction(transport, transaction, derivationPath);\n          transaction.addSignature(publicKey, signature);\n        }\n      } catch (error) {\n        throw new WalletSignTransactionError(error === null || error === void 0 ? void 0 : error.message, error);\n      }\n\n      return transactions;\n    } catch (error) {\n      this.emit('error', error);\n      throw error;\n    }\n  }\n\n}","map":{"version":3,"mappings":"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","names":["BaseSignerWalletAdapter","WalletConnectionError","WalletDisconnectedError","WalletDisconnectionError","WalletLoadError","WalletNotConnectedError","WalletNotReadyError","WalletPublicKeyError","WalletReadyState","WalletSignTransactionError","getDerivationPath","getPublicKey","signTransaction","LedgerWalletName","LedgerWalletAdapter","constructor","config","navigator","hid","Unsupported","Loadable","transport","_transport","off","_disconnected","_publicKey","emit","_derivationPath","derivationPath","_connecting","publicKey","connecting","readyState","_readyState","connect","connected","TransportWebHIDClass","default","error","message","create","on","disconnect","close","transaction","signature","addSignature","signAllTransactions","transactions"],"sources":["/Users/bryan/solana-crowdfunding/.yarn/cache/@solana-wallet-adapter-ledger-npm-0.9.9-06d562e868-d24109f659.zip/node_modules/@solana/wallet-adapter-ledger/src/adapter.ts"],"sourcesContent":["import type Transport from '@ledgerhq/hw-transport';\nimport type TransportWebHID from '@ledgerhq/hw-transport-webhid';\nimport {\n    BaseSignerWalletAdapter,\n    WalletConnectionError,\n    WalletDisconnectedError,\n    WalletDisconnectionError,\n    WalletLoadError,\n    WalletName,\n    WalletNotConnectedError,\n    WalletNotReadyError,\n    WalletPublicKeyError,\n    WalletReadyState,\n    WalletSignTransactionError,\n} from '@solana/wallet-adapter-base';\nimport { PublicKey, Transaction } from '@solana/web3.js';\nimport './polyfills/index';\nimport { getDerivationPath, getPublicKey, signTransaction } from './util';\n\nexport interface LedgerWalletAdapterConfig {\n    derivationPath?: Buffer;\n}\n\nexport const LedgerWalletName = 'Ledger' as WalletName;\n\nexport class LedgerWalletAdapter extends BaseSignerWalletAdapter {\n    name = LedgerWalletName;\n    url = 'https://ledger.com';\n    icon =\n        'data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzUgMzUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iI2ZmZiI+PHBhdGggZD0ibTIzLjU4OCAwaC0xNnYyMS41ODNoMjEuNnYtMTZhNS41ODUgNS41ODUgMCAwIDAgLTUuNi01LjU4M3oiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuNzM5KSIvPjxwYXRoIGQ9Im04LjM0MiAwaC0yLjc1N2E1LjU4NSA1LjU4NSAwIDAgMCAtNS41ODUgNS41ODV2Mi43NTdoOC4zNDJ6Ii8+PHBhdGggZD0ibTAgNy41OWg4LjM0MnY4LjM0MmgtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDUuNzM5KSIvPjxwYXRoIGQ9Im0xNS4xOCAyMy40NTFoMi43NTdhNS41ODUgNS41ODUgMCAwIDAgNS41ODUtNS42di0yLjY3MWgtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMS40NzggMTEuNDc4KSIvPjxwYXRoIGQ9Im03LjU5IDE1LjE4aDguMzQydjguMzQyaC04LjM0MnoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuNzM5IDExLjQ3OCkiLz48cGF0aCBkPSJtMCAxNS4xOHYyLjc1N2E1LjU4NSA1LjU4NSAwIDAgMCA1LjU4NSA1LjU4NWgyLjc1N3YtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDExLjQ3OCkiLz48L2c+PC9zdmc+';\n\n    private _derivationPath: Buffer;\n    private _connecting: boolean;\n    private _transport: Transport | null;\n    private _publicKey: PublicKey | null;\n    private _readyState: WalletReadyState =\n        typeof navigator === 'undefined' || !navigator.hid ? WalletReadyState.Unsupported : WalletReadyState.Loadable;\n\n    constructor(config: LedgerWalletAdapterConfig = {}) {\n        super();\n        this._derivationPath = config.derivationPath || getDerivationPath(0, 0);\n        this._connecting = false;\n        this._transport = null;\n        this._publicKey = null;\n    }\n\n    get publicKey(): PublicKey | null {\n        return this._publicKey;\n    }\n\n    get connecting(): boolean {\n        return this._connecting;\n    }\n\n    get readyState(): WalletReadyState {\n        return this._readyState;\n    }\n\n    async connect(): Promise<void> {\n        try {\n            if (this.connected || this.connecting) return;\n            if (this._readyState === WalletReadyState.Unsupported) throw new WalletNotReadyError();\n\n            this._connecting = true;\n\n            let TransportWebHIDClass: typeof TransportWebHID;\n            try {\n                ({ default: TransportWebHIDClass } = await import('@ledgerhq/hw-transport-webhid'));\n            } catch (error: any) {\n                throw new WalletLoadError(error?.message, error);\n            }\n\n            let transport: Transport;\n            try {\n                transport = await TransportWebHIDClass.create();\n            } catch (error: any) {\n                throw new WalletConnectionError(error?.message, error);\n            }\n\n            let publicKey: PublicKey;\n            try {\n                publicKey = await getPublicKey(transport, this._derivationPath);\n            } catch (error: any) {\n                throw new WalletPublicKeyError(error?.message, error);\n            }\n\n            transport.on('disconnect', this._disconnected);\n\n            this._transport = transport;\n            this._publicKey = publicKey;\n\n            this.emit('connect', publicKey);\n        } catch (error: any) {\n            this.emit('error', error);\n            throw error;\n        } finally {\n            this._connecting = false;\n        }\n    }\n\n    async disconnect(): Promise<void> {\n        const transport = this._transport;\n        if (transport) {\n            transport.off('disconnect', this._disconnected);\n\n            this._transport = null;\n            this._publicKey = null;\n\n            try {\n                await transport.close();\n            } catch (error: any) {\n                this.emit('error', new WalletDisconnectionError(error?.message, error));\n            }\n        }\n\n        this.emit('disconnect');\n    }\n\n    async signTransaction(transaction: Transaction): Promise<Transaction> {\n        try {\n            const transport = this._transport;\n            const publicKey = this._publicKey;\n            if (!transport || !publicKey) throw new WalletNotConnectedError();\n\n            try {\n                const signature = await signTransaction(transport, transaction, this._derivationPath);\n                transaction.addSignature(publicKey, signature);\n            } catch (error: any) {\n                throw new WalletSignTransactionError(error?.message, error);\n            }\n\n            return transaction;\n        } catch (error: any) {\n            this.emit('error', error);\n            throw error;\n        }\n    }\n\n    async signAllTransactions(transactions: Transaction[]): Promise<Transaction[]> {\n        try {\n            const transport = this._transport;\n            const publicKey = this._publicKey;\n            if (!transport || !publicKey) throw new WalletNotConnectedError();\n\n            try {\n                const derivationPath = this._derivationPath;\n                for (const transaction of transactions) {\n                    const signature = await signTransaction(transport, transaction, derivationPath);\n                    transaction.addSignature(publicKey, signature);\n                }\n            } catch (error: any) {\n                throw new WalletSignTransactionError(error?.message, error);\n            }\n\n            return transactions;\n        } catch (error: any) {\n            this.emit('error', error);\n            throw error;\n        }\n    }\n\n    private _disconnected = () => {\n        const transport = this._transport;\n        if (transport) {\n            transport.off('disconnect', this._disconnected);\n\n            this._transport = null;\n            this._publicKey = null;\n\n            this.emit('error', new WalletDisconnectedError());\n            this.emit('disconnect');\n        }\n    };\n}\n"]},"metadata":{},"sourceType":"module"}